# P2P v5.3.2

**Release Date:** December 5, 2025
**Tags:** BUG FIXES, ADMIN DASHBOARD, UI/UX, DISPUTE MANAGEMENT, REAL-TIME UPDATES

## Fixed

### Admin Trade Page

- **Notification Sound**: Fixed notification sound playing on initial page load
  - Sound now only plays when new messages arrive after page load
  - Prevents annoying sound on every page refresh

- **Chat Tab Improvements**: Enhanced real-time chat functionality
  - Fixed WebSocket connection for real-time message updates
  - Messages now properly display with sender names and avatars
  - Admin messages clearly distinguished from user messages

- **Confirmation Dialogs**: Replaced bottom-of-page confirmation cards with proper modal dialogs
  - Actions now show confirmation in centered modal dialogs
  - Proper styling for both dark and light modes
  - Cancel and Flag trade confirmations use modal dialogs

### Admin Dispute Page

- **Chat Tab Removed**: Simplified dispute page by removing non-functional chat tab
  - Reduced from 4 tabs to 3 tabs (Overview, Timeline, Evidence)
  - Chat functionality available through the trade page instead

- **Schema Validation Errors**: Fixed resolution submission errors
  - Resolution outcome values now use correct uppercase format (BUYER_WINS, SELLER_WINS, SPLIT)
  - Status values now use correct uppercase format (PENDING, IN_PROGRESS, RESOLVED)
  - Mark as In Progress action now sends correct status value

- **Error Handling**: Improved error handling during dispute resolution
  - Errors now display properly instead of redirecting to success page
  - Redirect only happens on successful resolution
  - Store errors properly captured and displayed to user

- **Resolution Details Display**: Fixed resolution information not showing correctly
  - Now properly parses resolution data when stored as JSON string
  - Shows correct outcome label (Buyer, Seller, Both Parties, Cancelled)
  - Displays admin's resolution notes correctly
  - Fixed double colon in "Resolved on" label
  - Added dark mode support for resolution details card

- **Confirmation Modal**: Added confirmation dialog before resolving disputes
  - Shows warning icon and selected outcome
  - Prevents accidental dispute resolution
  - Modal closes before processing to show any errors

- **Evidence Upload**: Fixed admin evidence upload functionality
  - Fixed "existingEvidence.push is not a function" error
  - Now properly parses evidence array when stored as JSON string
  - Restricted uploads to images only (JPEG, PNG, GIF, WebP)
  - Added validation on both frontend and backend
  - Updated UI to show image-only upload instructions

### Dispute List Page

- **Column Reordering**: Status column moved before Reported By column
  - Better visibility of dispute status at a glance
  - New order: Dispute ID, Trade, Status, Reported By, Against, Reason, Filed On, Priority, Actions

## Improved

### User Experience

- **Modal Dialogs**: Consistent modal dialog usage for confirmations
  - All confirmation actions now use shadcn/ui Dialog component
  - Proper dark/light mode color support
  - Better accessibility with focus management

- **Date Formatting**: Improved date display in resolution details
  - Human-readable format (e.g., "December 5, 2025 at 03:10 PM")
  - Fallback handling for missing dates

### Code Quality

- **JSON Parsing**: Robust handling of JSON fields throughout dispute management
  - Resolution, evidence, and timeline fields all properly parsed
  - Handles both string and object data formats
  - Graceful fallbacks when parsing fails

- **Type Safety**: Improved type consistency with backend
  - Status enums match backend expectations (uppercase)
  - Outcome enums match backend expectations (uppercase with underscores)
