# Core v5.7.2

**Release Date:** November 29, 2025
**Tags:** FEATURES, IMPROVEMENTS, BUG FIXES, ECOSYSTEM, NFT, PAYMENTS

## Added

### Ecosystem Trading

- **Market Data WebSocket**: Implemented real-time trades and OHLCV (candlestick) data streaming
  - Live trade history showing recent buy/sell transactions with prices and amounts
  - Real-time candlestick charts with configurable intervals (1m, 5m, 1h, 1d, etc.)
  - Automatic updates only when new data is available to reduce bandwidth
  - Supports custom data limits for different chart requirements
  - Properly handles high-volume trading data from Scylla database

### NFT Marketplace

- **Auction Enhancements**: Dynamic minimum bid increment functionality
  - Admins can configure minimum bid increments per auction
  - Ensures fair bidding with customizable increment requirements
  - Prevents bid sniping with proper increment enforcement

- **Collection Watchers**: Watchers count tracking
  - Users can watch/unwatch NFT collections they're interested in
  - Real-time watcher count display on collection pages
  - Helps gauge collection popularity and community interest

- **Withdrawal Tracking**: Proper pending withdrawal status
  - Clear status indicators for NFT withdrawal requests
  - Accurate tracking throughout the withdrawal process
  - Better user experience for NFT transfers

- **Collection Deployment**: Seamless frontend to backend connection
  - Smooth NFT collection deployment workflow
  - Proper error handling and status updates during deployment
  - Smart contract deployment integration

- **Marketplace Pause Status**: Emergency pause functionality
  - Admins can pause/unpause marketplace trading when needed
  - Emergency stop for security incidents or maintenance
  - Clear UI indication when marketplace is paused

## Improved

### Ecosystem Operations

- **Ledger Network Filtering**: Enhanced admin ledger view
  - Filters transactions by configured network (mainnet/testnet)
  - Admins only see network-relevant transactions based on environment settings
  - Reduces clutter and improves data accuracy for multi-network setups

- **Withdrawal Notifications**: Admin alerts for transaction failures
  - Critical notifications when blockchain withdrawal verification fails
  - System and individual admin notifications with transaction details
  - Enables immediate manual review and intervention

### Payment Processing

- **DLocal Integration Enhancements**:
  - **Deposit Notifications**: Users receive immediate in-app notifications for deposit success or failure
    - Clear success messages with deposit details
    - Failure notifications with error explanations
    - Email notifications ready for integration

  - **Refund Handling**: Automated wallet deduction with user and admin notifications
    - Detects full and partial refunds from payment provider
    - Automatically adjusts user wallet balance
    - Prevents negative balances with safety checks
    - Notifies users and admins with refund details

  - **Chargeback Protection**: Critical fraud detection and prevention system
    - Automatically detects chargebacks from payment provider
    - Deducts chargeback amount from user wallet
    - Sends critical alerts to all admins for immediate review
    - Detailed logging for compliance and audit requirements
    - Special handling for missing wallet scenarios

- **Paysafe Admin Profit Recording**: Fixed profit tracking for deposit fees
  - Admin profit now properly recorded for Paysafe deposit fees
  - Consistent tracking across all payment providers
  - Accurate fee revenue reporting

### User Management

- **Investment History**: Enabled duration column sorting
  - Users can now sort investment history by duration
  - Better data organization and easier filtering
  - Improved portfolio management experience

- **User Import**: Welcome notifications for imported users
  - Newly imported users receive personalized welcome messages
  - In-app greeting with account details
  - Better onboarding experience for bulk-imported users

### Code Quality

- **OTP Recovery Codes**: Verified correct implementation
  - Accepts both hyphenated (XXXX-XXXX-XXXX) and plain (XXXXXXXXXXXX) formats
  - Generates exactly 12 unique recovery codes per user
  - Proper normalization and validation working as designed

- **Code Cleanup**: Comprehensive code audit completed
  - All commented code serves legitimate documentation purposes
  - No dead or unnecessary code found

## Fixed

### Binary Trading

- **Order Profit Display**: Fixed profit/loss recording for completed orders
  - Loss orders now properly store the loss amount in the profit field
  - Enables accurate P/L display in trading history
  - Fixed all determination functions (Rise/Fall, Higher/Lower, Touch/No Touch, Call/Put, Turbo)

- **Trading History Display**: Fixed profit/loss color and sign indicators
  - WIN orders now show green with "+" prefix
  - LOSS orders now show red with "-" prefix
  - Total profit calculation properly adds wins and subtracts losses
  - Prevents confusion with loss amounts displaying as positive values

- **Currency Display**: Replaced hardcoded dollar signs with dynamic currency extraction
  - Automatically extracts currency from trading pair (e.g., BTC/USDT â†’ USDT)
  - Updated in all binary trading components:
    - Trade confirmation modal
    - Profit display component
    - Active positions panel (Entry, Current, Amount, P/L)
    - Completed positions (desktop and mobile views)
    - Order panel amount display
    - Amount selector (main display and available balance)
  - Quick amount buttons optimized without currency suffix for compact display
  - Supports all trading pairs (USDT, EUR, BTC, etc.)

- **Balance Synchronization**: Fixed available balance showing incorrect amounts
  - Wallet balance now refetches from backend after orders complete
  - Added balance sync when fetching completed orders
  - Added balance sync when fetching active orders
  - Amount selector now displays actual wallet balance instead of stale cached value

### Finance

- **Transfer Validation**: Fixed recipient lookup always returning "not found"
  - Corrected UUID field mapping to use `id` instead of non-existent `uuid` field
  - Fixed recipient status validation to check for "ACTIVE" status explicitly
  - Transfer validation now works correctly for valid recipient UUIDs

### Build System

- **TypeScript Compilation**: Fixed type mismatches preventing successful builds
  - Resolved async/await pattern errors
  - Fixed property name mismatches in data structures
  - Backend now compiles without errors

### Database

- **MySQL Compatibility**: Fixed JSON syntax in P2P offer expiry handling
  - Corrected JSON parsing for MySQL/MariaDB compatibility
  - Proper offer expiration processing

### Assets

- **Missing Cryptocurrency Image**: Added FDUSD (First Digital USD) stablecoin image
  - Prevents broken image errors in crypto listings
  - Maintains visual consistency across all supported cryptocurrencies

**Email Service Integration**:

- Deposit success/failure notifications
- User import welcome emails